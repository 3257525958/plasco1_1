{#{% load static %}#}
{#<!DOCTYPE html>#}
{#<html lang="fa" dir="rtl">#}
{#<head>#}
{#    <meta charset="UTF-8">#}
{#    <meta name="viewport" content="width=device-width, initial-scale=1.0">#}
{#    <title>Ú†Ø§Ù¾ Ù„ÛŒØ¨Ù„ Ø¨Ø§ Ø¨Ø§Ø±Ú©Ø¯ ÙˆØ§Ù‚Ø¹ÛŒ</title>#}
{#    <style>#}
{#        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¯Ù‚ÛŒÙ‚ Ø¨Ø±Ø§ÛŒ Ú†Ø§Ù¾Ú¯Ø± Ù„ÛŒØ¨Ù„ */#}
{#        @page {#}
{#            size: 80mm auto;#}
{#            margin: 0mm;#}
{#        }#}
{##}
{#        * {#}
{#            margin: 0;#}
{#            padding: 0;#}
{#            box-sizing: border-box;#}
{#        }#}
{##}
{#        body {#}
{#            margin: 0;#}
{#            padding: 0;#}
{#            font-family: Arial, sans-serif;#}
{#        }#}
{##}
{#        @media screen {#}
{#            .print-only {#}
{#                display: none;#}
{#            }#}
{##}
{#            .screen-only {#}
{#                display: block;#}
{#                text-align: center;#}
{#                padding: 20px;#}
{#                font-family: 'Vazirmatn', sans-serif;#}
{#            }#}
{#        }#}
{##}
{#        @media print {#}
{#            .screen-only {#}
{#                display: none;#}
{#            }#}
{##}
{#            .print-only {#}
{#                display: block;#}
{#            }#}
{##}
{#            body {#}
{#                width: 80mm;#}
{#                margin: 0 auto;#}
{#                padding: 0;#}
{#                display: flex;#}
{#                justify-content: center;#}
{#                align-items: center;#}
{#                min-height: 100vh;#}
{#            }#}
{#        }#}
{##}
{#        /* Ø§Ø¨Ø¹Ø§Ø¯ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ù„ÛŒØ¨Ù„ 40x20mm */#}
{#        .label {#}
{#            width: 40mm;#}
{#            height: 20mm;#}
{#            border: 0.1mm solid #000;#}
{#            page-break-inside: avoid;#}
{#            position: relative;#}
{#            display: inline-block;#}
{#            margin: 0mm;#}
{#            padding: 0mm;#}
{#            overflow: hidden;#}
{#        }#}
{##}
{#        /* Ø§Ø¨Ø¹Ø§Ø¯ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø¨Ø§Ø±Ú©Ø¯ EAN-13 */#}
{#        .barcode-container {#}
{#            position: absolute;#}
{#            top: 3mm;#}
{#            left: 3.5mm;#}
{#            width: 33mm;#}
{#            height: 14mm;#}
{#        }#}
{##}
{#        .barcode-image {#}
{#            width: 33mm;#}
{#            height: 10mm;#}
{#            display: block;#}
{#            image-rendering: crisp-edges;#}
{#            image-rendering: pixelated;#}
{#        }#}
{##}
{#        .barcode-number {#}
{#            font-family: 'OCRB', 'Courier New', monospace;#}
{#            font-size: 2.2mm;#}
{#            text-align: center;#}
{#            letter-spacing: 0.3mm;#}
{#            margin-top: 0.5mm;#}
{#            direction: ltr;#}
{#            font-weight: bold;#}
{#        }#}
{##}
{#        .product-name {#}
{#            position: absolute;#}
{#            top: 0.5mm;#}
{#            left: 0;#}
{#            width: 100%;#}
{#            text-align: center;#}
{#            font-size: 2.5mm;#}
{#            font-weight: bold;#}
{#            font-family: 'Vazirmatn', sans-serif;#}
{#        }#}
{##}
{#        .price {#}
{#            position: absolute;#}
{#            bottom: 0.5mm;#}
{#            left: 0;#}
{#            width: 100%;#}
{#            text-align: center;#}
{#            font-size: 3mm;#}
{#            font-weight: bold;#}
{#            font-family: 'Vazirmatn', sans-serif;#}
{#        }#}
{##}
{#        /* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø§ØµÙ„ÛŒ Ø¨Ø±Ø§ÛŒ ÙˆØ³Ø·â€ŒÚ†ÛŒÙ†ÛŒ */#}
{#        .print-container {#}
{#            width: 80mm;#}
{#            display: flex;#}
{#            justify-content: center;#}
{#            align-items: center;#}
{#            height: 100vh;#}
{#        }#}
{##}
{#        /* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø¨Ø±Ø§ÛŒ 2 Ù„ÛŒØ¨Ù„ Ø¯Ø± ÛŒÚ© Ø±Ø¯ÛŒÙ */#}
{#        .labels-row {#}
{#            display: flex;#}
{#            justify-content: center;#}
{#            align-items: center;#}
{#            gap: 3mm;#}
{#            margin: 0 auto;#}
{#            width: fit-content;#}
{#        }#}
{##}
{#        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØµÙØ­Ù‡ Ù†Ù…Ø§ÛŒØ´ */#}
{#        .screen-only {#}
{#            max-width: 800px;#}
{#            margin: 0 auto;#}
{#            padding: 20px;#}
{#        }#}
{##}
{#        .summary-box {#}
{#            background: #e8f5e9;#}
{#            padding: 20px;#}
{#            border-radius: 10px;#}
{#            margin: 20px 0;#}
{#        }#}
{##}
{#        .summary-item {#}
{#            display: flex;#}
{#            justify-content: space-between;#}
{#            padding: 8px 0;#}
{#            border-bottom: 1px solid #c8e6c9;#}
{#        }#}
{##}
{#        .btn {#}
{#            padding: 12px 24px;#}
{#            margin: 10px;#}
{#            border: none;#}
{#            border-radius: 8px;#}
{#            font-size: 1rem;#}
{#            font-weight: bold;#}
{#            cursor: pointer;#}
{#            display: inline-flex;#}
{#            align-items: center;#}
{#            gap: 8px;#}
{#            transition: all 0.3s ease;#}
{#            font-family: 'Vazirmatn', sans-serif;#}
{#        }#}
{##}
{#        .btn-primary {#}
{#            background: linear-gradient(45deg, #4CAF50, #2E7D32);#}
{#            color: white;#}
{#        }#}
{##}
{#        .btn-secondary {#}
{#            background: #f0f0f0;#}
{#            color: #333;#}
{#        }#}
{##}
{#        .preview-label {#}
{#            width: 40mm;#}
{#            height: 20mm;#}
{#            border: 1px dashed #999;#}
{#            display: inline-block;#}
{#            margin: 5px;#}
{#            vertical-align: top;#}
{#            position: relative;#}
{#        }#}
{#    </style>#}
{#    <!-- Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ JsBarcode Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯ ÙˆØ§Ù‚Ø¹ÛŒ -->#}
{#    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>#}
{#    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet">#}
{#</head>#}
{#<body>#}
{#    <!-- Ø¨Ø®Ø´ Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ù‡ -->#}
{#    <div class="screen-only">#}
{#        <h2>ğŸ–¨ï¸ ØµÙØ­Ù‡ Ú†Ø§Ù¾ Ù„ÛŒØ¨Ù„ Ø¨Ø§Ø±Ú©Ø¯</h2>#}
{##}
{#        <div class="summary-box">#}
{#            <h3>ğŸ“‹ Ø®Ù„Ø§ØµÙ‡ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§</h3>#}
{#            {% regroup all_labels by product_name as product_list %}#}
{#            {% for product in product_list %}#}
{#            <div class="summary-item">#}
{#                <span>{{ product.grouper }}</span>#}
{#                <strong>{{ product.list|length }} Ù„ÛŒØ¨Ù„</strong>#}
{#            </div>#}
{#            {% endfor %}#}
{#            <div class="summary-item" style="background: #4CAF50; color: white; border-radius: 5px;">#}
{#                <span>ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§:</span>#}
{#                <strong>{{ total_labels }} Ø¹Ø¯Ø¯</strong>#}
{#            </div>#}
{#        </div>#}
{##}
{#        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin: 20px 0;">#}
{#            <h3>âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú†Ø§Ù¾</h3>#}
{#            <p>â€¢ Ø³Ø§ÛŒØ² Ù„ÛŒØ¨Ù„: 40Ã—20 Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ±</p>#}
{#            <p>â€¢ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø¨Ø§Ø±Ú©Ø¯: EAN-13</p>#}
{#            <p>â€¢ Ú†ÛŒØ¯Ù…Ø§Ù†: Û² Ù„ÛŒØ¨Ù„ Ø¯Ø± Ù‡Ø± Ø±Ø¯ÛŒÙ</p>#}
{#            <p>â€¢ ÙØ§ØµÙ„Ù‡ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§: Û³ Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ±</p>#}
{#        </div>#}
{##}
{#        <!-- Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ -->#}
{#        <div style="text-align: center; margin: 30px 0;">#}
{#            <h3>ğŸ‘ï¸ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§</h3>#}
{#            <div style="display: inline-block; border: 2px dashed #999; padding: 10px; border-radius: 8px;">#}
{#                {% for label in all_labels|slice:":4" %}#}
{#                    {% if forloop.counter0|divisibleby:2 %}<div>{% endif %}#}
{#                    <div class="preview-label">#}
{#                        {% if label.show_name %}#}
{#                        <div class="product-name">{{ label.product_name|truncatechars:20 }}</div>#}
{#                        {% endif %}#}
{#                        <div class="barcode-container">#}
{#                            <svg class="barcode-image preview-barcode"#}
{#                                 data-barcode="{{ label.barcode }}"></svg>#}
{#                            <div class="barcode-number">{{ label.barcode }}</div>#}
{#                        </div>#}
{#                        {% if label.show_price %}#}
{#                        <div class="price">{{ label.price|floatformat:0 }} ØªÙˆÙ…Ø§Ù†</div>#}
{#                        {% endif %}#}
{#                    </div>#}
{#                    {% if forloop.counter|divisibleby:2 or forloop.last %}</div>{% endif %}#}
{#                {% endfor %}#}
{#            </div>#}
{#            {% if total_labels > 4 %}#}
{#            <p style="color: #666; margin-top: 10px;">Ùˆ {{ total_labels|add:"-4" }} Ù„ÛŒØ¨Ù„ Ø¯ÛŒÚ¯Ø±...</p>#}
{#            {% endif %}#}
{#        </div>#}
{##}
{#        <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù‚Ø¯Ø§Ù… -->#}
{#        <div style="text-align: center; margin: 30px 0;">#}
{#            <form method="post" style="display: inline;">#}
{#                {% csrf_token %}#}
{#                <button type="submit" class="btn btn-primary">#}
{#                    <i class="fas fa-print"></i> ØªØ§ÛŒÛŒØ¯ Ùˆ Ú†Ø§Ù¾ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§#}
{#                </button>#}
{#            </form>#}
{#            <button onclick="printLabels()" class="btn btn-primary">#}
{#                <i class="fas fa-print"></i> Ú†Ø§Ù¾ Ù…Ø³ØªÙ‚ÛŒÙ…#}
{#            </button>#}
{#            <button onclick="printExtraThickBarcode()" class="btn btn-primary">#}
{#                <i class="fas fa-bolt"></i> Ú†Ø§Ù¾ Ø¨Ø§Ø±Ú©Ø¯ ÙÙˆÙ‚ Ù¾Ø±Ø±Ù†Ú¯#}
{#            </button>#}
{#            <a href="{% url 'label_settings' %}" class="btn btn-secondary">#}
{#                <i class="fas fa-arrow-right"></i> Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª#}
{#            </a>#}
{#            <a href="{% url 'label_generator' %}" class="btn btn-secondary">#}
{#                <i class="fas fa-shopping-cart"></i> Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø§Ù„Ø§#}
{#            </a>#}
{#        </div>#}
{##}
{#        <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 20px 0;">#}
{#            <h4>ğŸ“ Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ Ú†Ø§Ù¾:</h4>#}
{#            <ol style="text-align: right; margin-right: 20px;">#}
{#                <li><strong>ØªØ§ÛŒÛŒØ¯ Ùˆ Ú†Ø§Ù¾ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§:</strong> ÙˆØ¶Ø¹ÛŒØª Ú†Ø§Ù¾ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø«Ø¨Øª Ù…ÛŒâ€ŒØ´ÙˆØ¯</li>#}
{#                <li><strong>Ú†Ø§Ù¾ Ù…Ø³ØªÙ‚ÛŒÙ…:</strong> ÙÙ‚Ø· Ú†Ø§Ù¾ Ù…ÛŒâ€ŒÚ©Ù†Ø¯ Ø¨Ø¯ÙˆÙ† Ø«Ø¨Øª Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³</li>#}
{#                <li><strong>Ú†Ø§Ù¾ Ø¨Ø§Ø±Ú©Ø¯ ÙÙˆÙ‚ Ù¾Ø±Ø±Ù†Ú¯:</strong> Ø¨Ø±Ø§ÛŒ Ú†Ø§Ù¾Ú¯Ø±Ù‡Ø§ÛŒ Ù…Ø´Ú©Ù„â€ŒØ¯Ø§Ø±</li>#}
{#                <li>Ø¯Ø± Ù¾Ù†Ø¬Ø±Ù‡ Ú†Ø§Ù¾ØŒ Ú†Ø§Ù¾Ú¯Ø± Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</li>#}
{#                <li>ØªÙ†Ø¸ÛŒÙ…Ø§Øª ØµÙØ­Ù‡: <strong>Ø³Ø§ÛŒØ²: 80mm auto | Ø­Ø§Ø´ÛŒÙ‡: None</strong></li>#}
{#            </ol>#}
{#        </div>#}
{#    </div>#}
{##}
{#    <!-- Ø¨Ø®Ø´ Ú†Ø§Ù¾ -->#}
{#    <div class="print-only" id="print-area">#}
{#        {% for label in all_labels %}#}
{#            {% if forloop.counter0|divisibleby:2 %}#}
{#            <div class="print-container">#}
{#                <div class="labels-row">#}
{#            {% endif %}#}
{##}
{#            <div class="label">#}
{#                {% if label.show_name %}#}
{#                <div class="product-name">{{ label.product_name|truncatechars:20 }}</div>#}
{#                {% endif %}#}
{##}
{#                <div class="barcode-container">#}
{#                    <svg class="barcode-image" id="barcode-{{ forloop.counter0 }}"></svg>#}
{#                    <div class="barcode-number">{{ label.barcode }}</div>#}
{#                </div>#}
{##}
{#                {% if label.show_price %}#}
{#                <div class="price">{{ label.price|floatformat:0 }} ØªÙˆÙ…Ø§Ù†</div>#}
{#                {% endif %}#}
{#            </div>#}
{##}
{#            {% if forloop.counter|divisibleby:2 or forloop.last %}#}
{#                </div>#}
{#            </div>#}
{#            {% if not forloop.last %}#}
{#            <div style="page-break-before: always;"></div>#}
{#            {% endif %}#}
{#            {% endif %}#}
{#        {% endfor %}#}
{#    </div>#}
{##}
{#    <script>#}
{#        // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§Ø±Ú©Ø¯#}
{#        const barcodeSettings = {#}
{#            format: "EAN13",#}
{#            width: 2.5,#}
{#            height: 100,#}
{#            displayValue: false,#}
{#            fontSize: 0,#}
{#            margin: 8,#}
{#            background: "#FFFFFF",#}
{#            lineColor: "#000000",#}
{#            flat: true#}
{#        };#}
{##}
{#        const extraThickBarcodeSettings = {#}
{#            format: "EAN13",#}
{#            width: 3.0,#}
{#            height: 110,#}
{#            displayValue: false,#}
{#            fontSize: 0,#}
{#            margin: 5,#}
{#            background: "#FFFFFF",#}
{#            lineColor: "#000000",#}
{#            flat: true#}
{#        };#}
{##}
{#        // ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯Ù‡Ø§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ#}
{#        function generateBarcodes(settings = barcodeSettings) {#}
{#            // ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´#}
{#            document.querySelectorAll('.preview-barcode').forEach((svg, index) => {#}
{#                const barcode = svg.getAttribute('data-barcode');#}
{#                if (barcode) {#}
{#                    try {#}
{#                        JsBarcode(svg, barcode, settings);#}
{#                    } catch (e) {#}
{#                        console.error('Ø®Ø·Ø§ Ø¯Ø± ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯:', e);#}
{#                    }#}
{#                }#}
{#            });#}
{##}
{#            // ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯ Ø¨Ø±Ø§ÛŒ Ú†Ø§Ù¾#}
{#            document.querySelectorAll('.barcode-image').forEach((svg, index) => {#}
{#                const barcode = svg.parentElement.querySelector('.barcode-number').textContent.trim();#}
{#                if (barcode) {#}
{#                    try {#}
{#                        JsBarcode(svg, barcode, settings);#}
{#                    } catch (e) {#}
{#                        console.error('Ø®Ø·Ø§ Ø¯Ø± ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯ Ú†Ø§Ù¾:', e);#}
{#                    }#}
{#                }#}
{#            });#}
{#        }#}
{##}
{#        // Ú†Ø§Ù¾ Ù…Ø³ØªÙ‚ÛŒÙ…#}
{#        function printLabels() {#}
{#            generateBarcodes(barcodeSettings);#}
{#            setTimeout(function() {#}
{#                console.log('ğŸ–¨ï¸ Ø´Ø±ÙˆØ¹ Ú†Ø§Ù¾ Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯...');#}
{#                window.print();#}
{#            }, 500);#}
{#        }#}
{##}
{#        // Ú†Ø§Ù¾ Ø¨Ø§Ø±Ú©Ø¯ ÙÙˆÙ‚ Ù¾Ø±Ø±Ù†Ú¯#}
{#        function printExtraThickBarcode() {#}
{#            generateBarcodes(extraThickBarcodeSettings);#}
{#            setTimeout(function() {#}
{#                console.log('ğŸ–¨ï¸ Ø´Ø±ÙˆØ¹ Ú†Ø§Ù¾ Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙÙˆÙ‚â€ŒÙ¾Ø±Ø±Ù†Ú¯...');#}
{#                window.print();#}
{#            }, 500);#}
{#        }#}
{##}
{#        // Ø§Ú¯Ø± ÙÙ„Ú¯ Ú†Ø§Ù¾ Ø®ÙˆØ¯Ú©Ø§Ø± ÙØ¹Ø§Ù„ Ø¨Ø§Ø´Ø¯#}
{#        {% if auto_print %}#}
{#        setTimeout(function() {#}
{#            generateBarcodes(barcodeSettings);#}
{#            setTimeout(function() {#}
{#                window.print();#}
{#            }, 1000);#}
{#        }, 500);#}
{#        {% endif %}#}
{##}
{#        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡#}
{#        document.addEventListener('DOMContentLoaded', function() {#}
{#            console.log('ğŸ” Ø³ÛŒØ³ØªÙ… Ú†Ø§Ù¾ Ù„ÛŒØ¨Ù„ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª');#}
{#            console.log('ğŸ“‹ ØªØ¹Ø¯Ø§Ø¯ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§: {{ total_labels }}');#}
{##}
{#            // ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´#}
{#            if (!{% if auto_print %}true{% else %}false{% endif %}) {#}
{#                generateBarcodes(barcodeSettings);#}
{#            }#}
{#        });#}
{##}
{#        // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ú†Ø§Ù¾#}
{#        window.onbeforeprint = function() {#}
{#            console.log('ğŸ–¨ï¸ Ø¢Ù…Ø§Ø¯Ù‡ Ú†Ø§Ù¾ {{ total_labels }} Ù„ÛŒØ¨Ù„...');#}
{#        };#}
{##}
{#        window.onafterprint = function() {#}
{#            console.log('âœ… Ú†Ø§Ù¾ Ú©Ø§Ù…Ù„ Ø´Ø¯');#}
{#            setTimeout(function() {#}
{#                alert('{{ total_labels }} Ù„ÛŒØ¨Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ú†Ø§Ù¾ Ø´Ø¯Ù†Ø¯.\nÙˆØ¶Ø¹ÛŒØª Ú†Ø§Ù¾ Ø¯Ø± Ø³ÛŒØ³ØªÙ… Ø«Ø¨Øª Ø´Ø¯.');#}
{#            }, 500);#}
{#        };#}
{#    </script>#}
{#</body>#}
{#</html>#}

{% load static %}
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ú†Ø§Ù¾ Ù„ÛŒØ¨Ù„ Ø¨Ø§ Ø¨Ø§Ø±Ú©Ø¯ ÙˆØ§Ù‚Ø¹ÛŒ</title>
    <style>
        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¯Ù‚ÛŒÙ‚ Ø¨Ø±Ø§ÛŒ Ú†Ø§Ù¾Ú¯Ø± Ù„ÛŒØ¨Ù„ */
        @page {
            size: 80mm auto;
            margin: 0mm;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            margin: 0;
            padding: 0;
            font-family: Arial, sans-serif;
        }

        @media screen {
            .print-only {
                display: none;
            }

            .screen-only {
                display: block;
                text-align: center;
                padding: 20px;
                font-family: 'Vazirmatn', sans-serif;
            }
        }

        @media print {
            .screen-only {
                display: none;
            }

            .print-only {
                display: block;
            }

            body {
                width: 80mm;
                margin: 0 auto;
                padding: 0;
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
            }
        }

        /* Ø§Ø¨Ø¹Ø§Ø¯ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ù„ÛŒØ¨Ù„ 40x20mm Ø¨Ø¯ÙˆÙ† Ú©Ø§Ø¯Ø± */
        .label {
            width: 40mm;
            height: 20mm;
            border: none; /* Ø­Ø°Ù Ú©Ø§Ø¯Ø± Ø¯ÙˆØ± Ù„ÛŒØ¨Ù„ */
            page-break-inside: avoid;
            position: relative;
            display: inline-block;
            margin: 0mm;
            padding: 0mm;
            overflow: hidden;
        }

        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù†Ø§Ù… Ú©Ø§Ù„Ø§ - 1.2mm Ø§Ø² Ø¨Ø§Ù„Ø§ */
        .product-name {
            position: absolute;
            top: 1.2mm; /* Ø§ÙØ²Ø§ÛŒØ´ Ø§Ø² 0.2mm Ø¨Ù‡ 1.2mm */
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 1.8mm;
            font-weight: bold;
            font-family: 'Vazirmatn', sans-serif;
            line-height: 1.1;
            max-height: 2.5mm; /* Ú©Ù…ÛŒ Ú©Ø§Ù‡Ø´ Ø§Ø±ØªÙØ§Ø¹ */
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            padding: 0 0.5mm;
        }

        /* Ø§Ø¨Ø¹Ø§Ø¯ Ø§Ø³ØªØ§Ù†Ø¯Ø§Ø±Ø¯ Ø¨Ø§Ø±Ú©Ø¯ EAN-13 Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¬Ø¯ÛŒØ¯ */
        .barcode-container {
            position: absolute;
            top: 4.2mm; /* Ø§ÙØ²Ø§ÛŒØ´ Ø§Ø² 3.5mm Ø¨Ù‡ 4.2mm */
            left: 3.5mm;
            width: 33mm;
            height: 11mm;
        }

        .barcode-image {
            width: 33mm;
            height: 9mm;
            display: block;
            image-rendering: crisp-edges;
            image-rendering: pixelated;
        }

        /* ØªÙ†Ø¸ÛŒÙ… Ø¹Ø¯Ø¯ Ø¨Ø§Ø±Ú©Ø¯ - Ø±ÛŒØ²ØªØ± */
        .barcode-number {
            font-family: 'OCRB', 'Courier New', monospace;
            font-size: 1.5mm; /* Ø±ÛŒØ²ØªØ± Ø§Ø² Ù‚Ø¨Ù„ */
            text-align: center;
            letter-spacing: 0.2mm;
            margin-top: 0.3mm;
            direction: ltr;
            font-weight: bold;
            color: #000;
        }

        /* ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¬Ø¯ÛŒØ¯ Ø¨Ø±Ø§ÛŒ Ù‚ÛŒÙ…Øª */
        .price {
            position: absolute;
            bottom: 0.2mm;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 2.5mm;
            font-weight: bold;
            font-family: 'Vazirmatn', sans-serif;
        }

        /* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø§ØµÙ„ÛŒ Ø¨Ø±Ø§ÛŒ ÙˆØ³Ø·â€ŒÚ†ÛŒÙ†ÛŒ */
        .print-container {
            width: 80mm;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        /* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ø¨Ø±Ø§ÛŒ 2 Ù„ÛŒØ¨Ù„ Ø¯Ø± ÛŒÚ© Ø±Ø¯ÛŒÙ */
        .labels-row {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 3mm;
            margin: 0 auto;
            width: fit-content;
        }

        /* Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ ØµÙØ­Ù‡ Ù†Ù…Ø§ÛŒØ´ - Ù‡Ù…Ø³Ø§Ù† Ø¨Ø§ Ú†Ø§Ù¾ */
        .screen-only {
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }

        .summary-box {
            background: #e8f5e9;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
        }

        .summary-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #c8e6c9;
        }

        .btn {
            padding: 12px 24px;
            margin: 10px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
            font-family: 'Vazirmatn', sans-serif;
        }

        .btn-primary {
            background: linear-gradient(45deg, #4CAF50, #2E7D32);
            color: white;
        }

        .btn-secondary {
            background: #f0f0f0;
            color: #333;
        }

        /* Ù„ÛŒØ¨Ù„ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ - Ù‡Ù…Ø³Ø§Ù† Ø¨Ø§ Ú†Ø§Ù¾ */
        .preview-label {
            width: 40mm;
            height: 20mm;
            border: none; /* Ø¨Ø¯ÙˆÙ† Ú©Ø§Ø¯Ø± */
            display: inline-block;
            margin: 5px;
            vertical-align: top;
            position: relative;
            background: white;
        }

        /* Ú©Ø§Ù†ØªÛŒÙ†Ø± Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¨Ø§Ø±Ú©Ø¯ */
        .preview-barcode-container {
            position: absolute;
            top: 4.2mm; /* Ù‡Ù…Ø³Ø§Ù† Ø¨Ø§ Ú†Ø§Ù¾ */
            left: 3.5mm;
            width: 33mm;
            height: 11mm;
        }

        .preview-barcode {
            width: 33mm;
            height: 9mm;
        }

        .preview-barcode-number {
            font-family: 'Courier New', monospace;
            font-size: 1.5mm;
            text-align: center;
            margin-top: 0.3mm;
            direction: ltr;
            color: #000;
        }

        /* Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ù†Ø§Ù… Ú©Ø§Ù„Ø§ - Ù‡Ù…Ø³Ø§Ù† Ø¨Ø§ Ú†Ø§Ù¾ */
        .preview-product-name {
            position: absolute;
            top: 1.2mm; /* Ù‡Ù…Ø§Ù† ØªØºÛŒÛŒØ±Ø§Øª Ú†Ø§Ù¾ */
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 1.8mm;
            font-weight: bold;
            font-family: 'Vazirmatn', sans-serif;
            line-height: 1.1;
            max-height: 2.5mm;
            overflow: hidden;
            white-space: nowrap;
            text-overflow: ellipsis;
            padding: 0 0.5mm;
        }

        /* Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ù‚ÛŒÙ…Øª - Ù‡Ù…Ø³Ø§Ù† Ø¨Ø§ Ú†Ø§Ù¾ */
        .preview-price {
            position: absolute;
            bottom: 0.2mm;
            left: 0;
            width: 100%;
            text-align: center;
            font-size: 2.5mm;
            font-weight: bold;
            font-family: 'Vazirmatn', sans-serif;
        }
    </style>
    <!-- Ú©ØªØ§Ø¨Ø®Ø§Ù†Ù‡ JsBarcode Ø¨Ø±Ø§ÛŒ ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯ ÙˆØ§Ù‚Ø¹ÛŒ -->
    <script src="https://cdn.jsdelivr.net/npm/jsbarcode@3.11.5/dist/JsBarcode.all.min.js"></script>
    <link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazirmatn@v33.003/Vazirmatn-font-face.css" rel="stylesheet">
</head>
<body>
    <!-- Ø¨Ø®Ø´ Ù†Ù…Ø§ÛŒØ´ ØµÙØ­Ù‡ -->
    <div class="screen-only">
        <h2>ğŸ–¨ï¸ ØµÙØ­Ù‡ Ú†Ø§Ù¾ Ù„ÛŒØ¨Ù„ Ø¨Ø§Ø±Ú©Ø¯</h2>

        <div class="summary-box">
            <h3>ğŸ“‹ Ø®Ù„Ø§ØµÙ‡ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§</h3>
            {% regroup all_labels by product_name as product_list %}
            {% for product in product_list %}
            <div class="summary-item">
                <span>{{ product.grouper }}</span>
                <strong>{{ product.list|length }} Ù„ÛŒØ¨Ù„</strong>
            </div>
            {% endfor %}
            <div class="summary-item" style="background: #4CAF50; color: white; border-radius: 5px;">
                <span>ØªØ¹Ø¯Ø§Ø¯ Ú©Ù„ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§:</span>
                <strong>{{ total_labels }} Ø¹Ø¯Ø¯</strong>
            </div>
        </div>

        <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin: 20px 0;">
            <h3>âš™ï¸ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ú†Ø§Ù¾ (Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø´Ø¯Ù‡)</h3>
            <p>â€¢ Ø³Ø§ÛŒØ² Ù„ÛŒØ¨Ù„: 40Ã—20 Ù…ÛŒÙ„ÛŒâ€ŒÙ…ØªØ±</p>
            <p>â€¢ Ù†Ø§Ù… Ú©Ø§Ù„Ø§: ÙÙˆÙ†Øª 1.8mmØŒ 1.2mm Ø§Ø² Ø¨Ø§Ù„Ø§</p>
            <p>â€¢ Ø¨Ø§Ø±Ú©Ø¯: 4.2mm Ø§Ø² Ø¨Ø§Ù„Ø§</p>
            <p>â€¢ Ù‚ÛŒÙ…Øª: ÙÙˆÙ†Øª 2.5mm Ø¯Ø± Ù¾Ø§ÛŒÛŒÙ† Ù„ÛŒØ¨Ù„</p>
            <p>â€¢ Ø¹Ø¯Ø¯ Ø¨Ø§Ø±Ú©Ø¯: ÙÙˆÙ†Øª 1.5mm Ø±ÛŒØ² Ø¯Ø± Ø²ÛŒØ± Ø¨Ø§Ø±Ú©Ø¯</p>
            <p>â€¢ Ø¨Ø¯ÙˆÙ† Ú©Ø§Ø¯Ø± Ø¯ÙˆØ± Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§</p>
            <p style="color: #d32f2f; font-weight: bold;">ØªØºÛŒÛŒØ± Ù…Ù‡Ù…: Ù†Ø§Ù… Ú©Ø§Ù„Ø§ 1.2mm Ø§Ø² Ø¨Ø§Ù„Ø§ (Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ± Ø§Ø² Ù‚Ø¨Ù„)</p>
        </div>

        <!-- Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ - Ù‡Ù…Ø³Ø§Ù† Ø¨Ø§ Ú†Ø§Ù¾ -->
        <div style="text-align: center; margin: 30px 0;">
            <h3>ğŸ‘ï¸ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§ (Ù‡Ù…Ø³Ø§Ù† Ø¨Ø§ Ú†Ø§Ù¾)</h3>
            <div style="display: inline-block; background: white; padding: 10px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);">
                {% for label in all_labels|slice:":4" %}
                    {% if forloop.counter0|divisibleby:2 %}<div style="display: flex; justify-content: center; gap: 3mm;">{% endif %}
                    <div class="preview-label">
                        {% if label.show_name %}
                        <div class="preview-product-name">{{ label.product_name|truncatechars:25 }}</div>
                        {% endif %}

                        <div class="preview-barcode-container">
                            <svg class="preview-barcode"
                                 data-barcode="{{ label.barcode }}"></svg>
                            <div class="preview-barcode-number">{{ label.barcode }}</div>
                        </div>

                        {% if label.show_price %}
                        <div class="preview-price">{{ label.price|floatformat:0 }} ØªÙˆÙ…Ø§Ù†</div>
                        {% endif %}
                    </div>
                    {% if forloop.counter|divisibleby:2 or forloop.last %}</div>{% endif %}
                {% endfor %}
            </div>
            {% if total_labels > 4 %}
            <p style="color: #666; margin-top: 10px;">Ùˆ {{ total_labels|add:"-4" }} Ù„ÛŒØ¨Ù„ Ø¯ÛŒÚ¯Ø±...</p>
            {% endif %}
        </div>

        <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø§Ù‚Ø¯Ø§Ù… -->
        <div style="text-align: center; margin: 30px 0;">
            <form method="post" style="display: inline;">
                {% csrf_token %}
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-print"></i> ØªØ§ÛŒÛŒØ¯ Ùˆ Ú†Ø§Ù¾ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§
                </button>
            </form>
            <button onclick="printLabels()" class="btn btn-primary">
                <i class="fas fa-print"></i> Ú†Ø§Ù¾ Ù…Ø³ØªÙ‚ÛŒÙ…
            </button>
            <button onclick="printExtraThickBarcode()" class="btn btn-primary">
                <i class="fas fa-bolt"></i> Ú†Ø§Ù¾ Ø¨Ø§Ø±Ú©Ø¯ ÙÙˆÙ‚ Ù¾Ø±Ø±Ù†Ú¯
            </button>
            <a href="{% url 'label_settings' %}" class="btn btn-secondary">
                <i class="fas fa-arrow-right"></i> Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ØªÙ†Ø¸ÛŒÙ…Ø§Øª
            </a>
            <a href="{% url 'label_generator' %}" class="btn btn-secondary">
                <i class="fas fa-shopping-cart"></i> Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø§Ù„Ø§
            </a>
        </div>

        <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 20px 0;">
            <h4>ğŸ“ ØªØºÛŒÛŒØ±Ø§Øª Ø§Ø¹Ù…Ø§Ù„ Ø´Ø¯Ù‡:</h4>
            <ol style="text-align: right; margin-right: 20px;">
                <li><strong>Ù†Ø§Ù… Ú©Ø§Ù„Ø§ Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ± Ø±ÙØªÙ‡</strong>: Ø§Ø² 0.2mm Ø¨Ù‡ 1.2mm Ø§Ø² Ø¨Ø§Ù„Ø§</li>
                <li><strong>Ø¨Ø§Ø±Ú©Ø¯ Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ± Ø±ÙØªÙ‡</strong>: Ø§Ø² 3.5mm Ø¨Ù‡ 4.2mm Ø§Ø² Ø¨Ø§Ù„Ø§</li>
                <li><strong>Ø­ÙØ¸ ÙØ§ØµÙ„Ù‡ Ù…Ù†Ø§Ø³Ø¨</strong>: Ø¨ÛŒÙ† Ù†Ø§Ù… Ú©Ø§Ù„Ø§ Ùˆ Ø¨Ø§Ø±Ú©Ø¯ 3.0mm ÙØ§ØµÙ„Ù‡</li>
                <li><strong>Ù‡Ù…Ø³Ø§Ù†ÛŒ Ú©Ø§Ù…Ù„</strong>: Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ùˆ Ú†Ø§Ù¾ Ú©Ø§Ù…Ù„Ø§Ù‹ ÛŒÚ©Ø³Ø§Ù†</li>
                <li><strong>Ø¨Ø¯ÙˆÙ† Ú©Ø§Ø¯Ø±</strong>: Ú©Ø§Ø¯Ø± Ø¯ÙˆØ± Ù„ÛŒØ¨Ù„ Ø­Ø°Ù Ø´Ø¯Ù‡</li>
                <li><strong>Ø¹Ø¯Ø¯ Ø¨Ø§Ø±Ú©Ø¯ Ø±ÛŒØ²</strong>: ÙÙˆÙ†Øª 1.5mm Ø¨Ø±Ø§ÛŒ Ø®ÙˆØ§Ù†Ø§ÛŒÛŒ Ø¨Ù‡ØªØ±</li>
            </ol>
        </div>
    </div>

    <!-- Ø¨Ø®Ø´ Ú†Ø§Ù¾ -->
    <div class="print-only" id="print-area">
        {% for label in all_labels %}
            {% if forloop.counter0|divisibleby:2 %}
            <div class="print-container">
                <div class="labels-row">
            {% endif %}

            <div class="label">
                {% if label.show_name %}
                <div class="product-name">{{ label.product_name|truncatechars:25 }}</div>
                {% endif %}

                <div class="barcode-container">
                    <svg class="barcode-image" id="barcode-{{ forloop.counter0 }}"></svg>
                    <div class="barcode-number">{{ label.barcode }}</div>
                </div>

                {% if label.show_price %}
                <div class="price">{{ label.price|floatformat:0 }} ØªÙˆÙ…Ø§Ù†</div>
                {% endif %}
            </div>

            {% if forloop.counter|divisibleby:2 or forloop.last %}
                </div>
            </div>
            {% if not forloop.last %}
            <div style="page-break-before: always;"></div>
            {% endif %}
            {% endif %}
        {% endfor %}
    </div>

    <script>
        // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¨Ø§Ø±Ú©Ø¯
        const barcodeSettings = {
            format: "EAN13",
            width: 2.5,
            height: 100,
            displayValue: false,
            fontSize: 0,
            margin: 8,
            background: "#FFFFFF",
            lineColor: "#000000",
            flat: true
        };

        const extraThickBarcodeSettings = {
            format: "EAN13",
            width: 3.0,
            height: 110,
            displayValue: false,
            fontSize: 0,
            margin: 5,
            background: "#FFFFFF",
            lineColor: "#000000",
            flat: true
        };

        // ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯Ù‡Ø§ÛŒ ÙˆØ§Ù‚Ø¹ÛŒ
        function generateBarcodes(settings = barcodeSettings) {
            // ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´
            document.querySelectorAll('.preview-barcode').forEach((svg, index) => {
                const barcode = svg.getAttribute('data-barcode');
                if (barcode) {
                    try {
                        JsBarcode(svg, barcode, settings);
                    } catch (e) {
                        console.error('Ø®Ø·Ø§ Ø¯Ø± ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´:', e);
                    }
                }
            });

            // ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯ Ø¨Ø±Ø§ÛŒ Ú†Ø§Ù¾
            document.querySelectorAll('.barcode-image').forEach((svg, index) => {
                const barcode = svg.parentElement.querySelector('.barcode-number').textContent.trim();
                if (barcode) {
                    try {
                        JsBarcode(svg, barcode, settings);
                    } catch (e) {
                        console.error('Ø®Ø·Ø§ Ø¯Ø± ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯ Ú†Ø§Ù¾:', e);
                    }
                }
            });

            console.log('âœ… Ø¨Ø§Ø±Ú©Ø¯Ù‡Ø§ Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¬Ø¯ÛŒØ¯ ØªÙˆÙ„ÛŒØ¯ Ø´Ø¯Ù†Ø¯');
            console.log('ğŸ“ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¬Ø¯ÛŒØ¯: Ù†Ø§Ù… Ú©Ø§Ù„Ø§=1.2mm Ø§Ø² Ø¨Ø§Ù„Ø§ | Ø¨Ø§Ø±Ú©Ø¯=4.2mm Ø§Ø² Ø¨Ø§Ù„Ø§');
        }

        // Ú©ÙˆØªØ§Ù‡ Ú©Ø±Ø¯Ù† Ø®ÙˆØ¯Ú©Ø§Ø± Ù†Ø§Ù…â€ŒÙ‡Ø§ÛŒ Ø·ÙˆÙ„Ø§Ù†ÛŒ Ø¯Ø± Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´
        function truncateProductNames() {
            document.querySelectorAll('.product-name, .preview-product-name').forEach(el => {
                const text = el.textContent;
                if (text.length > 25) {
                    el.textContent = text.substring(0, 23) + '...';
                }
            });
        }

        // Ú†Ø§Ù¾ Ù…Ø³ØªÙ‚ÛŒÙ…
        function printLabels() {
            generateBarcodes(barcodeSettings);
            truncateProductNames();
            setTimeout(function() {
                console.log('ğŸ–¨ï¸ Ø´Ø±ÙˆØ¹ Ú†Ø§Ù¾ Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¬Ø¯ÛŒØ¯ (Ù†Ø§Ù… Ú©Ø§Ù„Ø§ Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ±)...');
                window.print();
            }, 500);
        }

        // Ú†Ø§Ù¾ Ø¨Ø§Ø±Ú©Ø¯ ÙÙˆÙ‚ Ù¾Ø±Ø±Ù†Ú¯
        function printExtraThickBarcode() {
            generateBarcodes(extraThickBarcodeSettings);
            truncateProductNames();
            setTimeout(function() {
                console.log('ğŸ–¨ï¸ Ø´Ø±ÙˆØ¹ Ú†Ø§Ù¾ Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª ÙÙˆÙ‚â€ŒÙ¾Ø±Ø±Ù†Ú¯...');
                window.print();
            }, 500);
        }

        // Ø§Ú¯Ø± ÙÙ„Ú¯ Ú†Ø§Ù¾ Ø®ÙˆØ¯Ú©Ø§Ø± ÙØ¹Ø§Ù„ Ø¨Ø§Ø´Ø¯
        {% if auto_print %}
        setTimeout(function() {
            generateBarcodes(barcodeSettings);
            truncateProductNames();
            setTimeout(function() {
                window.print();
            }, 1000);
        }, 500);
        {% endif %}

        // Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ Ø§ÙˆÙ„ÛŒÙ‡
        document.addEventListener('DOMContentLoaded', function() {
            console.log('ğŸ” Ø³ÛŒØ³ØªÙ… Ú†Ø§Ù¾ Ù„ÛŒØ¨Ù„ Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³Øª');
            console.log('ğŸ“‹ ØªØ¹Ø¯Ø§Ø¯ Ù„ÛŒØ¨Ù„â€ŒÙ‡Ø§: {{ total_labels }}');
            console.log('ğŸ¨ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¬Ø¯ÛŒØ¯: Ù†Ø§Ù… Ú©Ø§Ù„Ø§ 1.2mm Ø§Ø² Ø¨Ø§Ù„Ø§ØŒ Ø¨Ø§Ø±Ú©Ø¯ 4.2mm Ø§Ø² Ø¨Ø§Ù„Ø§');

            // ØªÙˆÙ„ÛŒØ¯ Ø¨Ø§Ø±Ú©Ø¯ Ø¨Ø±Ø§ÛŒ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´
            if (!{% if auto_print %}true{% else %}false{% endif %}) {
                generateBarcodes(barcodeSettings);
                truncateProductNames();
            }
        });

        // Ø±ÙˆÛŒØ¯Ø§Ø¯Ù‡Ø§ÛŒ Ú†Ø§Ù¾
        window.onbeforeprint = function() {
            console.log('ğŸ–¨ï¸ Ø¢Ù…Ø§Ø¯Ù‡ Ú†Ø§Ù¾ {{ total_labels }} Ù„ÛŒØ¨Ù„ Ø¨Ø§ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø¬Ø¯ÛŒØ¯...');
            console.log('âœ… Ù†Ø§Ù… Ú©Ø§Ù„Ø§: 1.2mm Ø§Ø² Ø¨Ø§Ù„Ø§ (Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ± Ø§Ø² Ù‚Ø¨Ù„)');
            console.log('âœ… Ø¨Ø§Ø±Ú©Ø¯: 4.2mm Ø§Ø² Ø¨Ø§Ù„Ø§');
            console.log('âœ… Ø¹Ø¯Ø¯ Ø¨Ø§Ø±Ú©Ø¯: Ø±ÛŒØ²ØŒ ÙÙˆÙ†Øª 1.5mm');
            console.log('âœ… Ù‚ÛŒÙ…Øª: Ù¾Ø§ÛŒÛŒÙ†ØŒ ÙÙˆÙ†Øª 2.5mm');
            console.log('âœ… Ø¨Ø¯ÙˆÙ† Ú©Ø§Ø¯Ø± Ø¯ÙˆØ± Ù„ÛŒØ¨Ù„');
        };

        window.onafterprint = function() {
            console.log('âœ… Ú†Ø§Ù¾ Ú©Ø§Ù…Ù„ Ø´Ø¯');
            setTimeout(function() {
                alert('{{ total_labels }} Ù„ÛŒØ¨Ù„ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ú†Ø§Ù¾ Ø´Ø¯Ù†Ø¯.\n\nØªØºÛŒÛŒØ±Ø§Øª Ø¬Ø¯ÛŒØ¯:\nâ€¢ Ù†Ø§Ù… Ú©Ø§Ù„Ø§ 1.2mm Ø§Ø² Ø¨Ø§Ù„Ø§ (Ù¾Ø§ÛŒÛŒÙ†â€ŒØªØ±)\nâ€¢ Ø¨Ø§Ø±Ú©Ø¯ 4.2mm Ø§Ø² Ø¨Ø§Ù„Ø§\nâ€¢ Ø¨Ø¯ÙˆÙ† Ú©Ø§Ø¯Ø± Ø¯ÙˆØ± Ù„ÛŒØ¨Ù„\nâ€¢ Ø¹Ø¯Ø¯ Ø¨Ø§Ø±Ú©Ø¯ Ø±ÛŒØ²ØªØ±');
            }, 500);
        };
    </script>
</body>
</html>