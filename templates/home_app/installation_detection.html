<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ´Ø®ÛŒØµ Ø­Ø§Ù„Øª Ø§Ø¬Ø±Ø§ - Plasco</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            max-width: 600px;
            width: 100%;
            text-align: center;
        }

        .logo {
            font-size: 3rem;
            margin-bottom: 20px;
        }

        h1 {
            color: #2d3748;
            margin-bottom: 10px;
            font-size: 2rem;
        }

        .subtitle {
            color: #718096;
            margin-bottom: 30px;
            font-size: 1.1rem;
        }

        .ip-info {
            background: #f7fafc;
            border: 2px solid #e2e8f0;
            border-radius: 10px;
            padding: 15px;
            margin: 20px 0;
        }

        .ip-info code {
            background: #edf2f7;
            padding: 5px 10px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            color: #2d3748;
        }

        .mode-selection {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin: 30px 0;
        }

        .mode-btn {
            background: white;
            border: 3px solid #e2e8f0;
            border-radius: 15px;
            padding: 30px 20px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
        }

        .mode-btn:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .mode-btn.online:hover {
            border-color: #4299e1;
        }

        .mode-btn.offline:hover {
            border-color: #48bb78;
        }

        .mode-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .mode-title {
            font-size: 1.3rem;
            font-weight: 600;
            margin-bottom: 10px;
            color: #2d3748;
        }

        .mode-desc {
            color: #718096;
            font-size: 0.9rem;
        }

        .installation-panel {
            display: none;
            background: #f7fafc;
            border-radius: 15px;
            padding: 25px;
            margin-top: 20px;
            text-align: right;
        }

        .step {
            margin-bottom: 25px;
            padding: 20px;
            background: white;
            border-radius: 10px;
            border-right: 4px solid #4299e1;
        }

        .step-header {
            display: flex;
            align-items: center;
            justify-content: between;
            margin-bottom: 15px;
        }

        .step-number {
            background: #4299e1;
            color: white;
            width: 30px;
            height: 30px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-left: 15px;
        }

        .step-title {
            font-weight: 600;
            color: #2d3748;
            flex-grow: 1;
        }

        .step-status {
            font-size: 0.9rem;
            padding: 5px 10px;
            border-radius: 15px;
        }

        .status-pending {
            background: #fed7d7;
            color: #c53030;
        }

        .status-running {
            background: #fefcbf;
            color: #d69e2e;
        }

        .status-completed {
            background: #c6f6d5;
            color: #276749;
        }

        .step-description {
            color: #718096;
            margin-bottom: 15px;
            line-height: 1.6;
        }

        .step-actions {
            display: flex;
            gap: 10px;
        }

        .btn {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #4299e1;
            color: white;
        }

        .btn-primary:hover {
            background: #3182ce;
        }

        .btn-success {
            background: #48bb78;
            color: white;
        }

        .btn-success:hover {
            background: #38a169;
        }

        .btn:disabled {
            background: #cbd5e0;
            cursor: not-allowed;
        }

        .progress-container {
            background: #e2e8f0;
            border-radius: 10px;
            height: 10px;
            margin: 20px 0;
            overflow: hidden;
        }

        .progress-bar {
            background: linear-gradient(45deg, #48bb78, #38a169);
            height: 100%;
            width: 0%;
            transition: width 0.5s ease;
        }

        .superuser-info {
            background: linear-gradient(135deg, #d1ecf1, #bee5eb);
            border: 2px solid #17a2b8;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            display: none;
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 25px;
            border-radius: 10px;
            color: white;
            font-weight: 600;
            z-index: 1000;
            transform: translateX(400px);
            transition: transform 0.3s ease;
        }

        .notification.show {
            transform: translateX(0);
        }

        .notification.success {
            background: #48bb78;
        }

        .notification.error {
            background: #e53e3e;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="logo">ğŸš€</div>
        <h1>Ø¨Ù‡ Plasco Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯</h1>
        <p class="subtitle">Ù„Ø·ÙØ§Ù‹ Ø­Ø§Ù„Øª Ø§Ø¬Ø±Ø§ÛŒ Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</p>

        <div class="ip-info">
            ğŸ“ Ø¢Ø¯Ø±Ø³ IP Ø´Ù…Ø§: <code id="clientIp">{{ client_ip }}</code>
        </div>

        <div class="mode-selection">
            <div class="mode-btn online" onclick="selectMode('online')">
                <div class="mode-icon">ğŸŒ</div>
                <div class="mode-title">Ø­Ø§Ù„Øª Ø¢Ù†Ù„Ø§ÛŒÙ†</div>
                <div class="mode-desc">
                    Ø§ØªØµØ§Ù„ Ø¨Ù‡ Ø³Ø±ÙˆØ± Ø§ØµÙ„ÛŒ<br>
                    Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ø²Ù†Ø¯Ù‡ Ùˆ Ø¨Ù‡â€ŒØ±ÙˆØ²
                </div>
            </div>

            <div class="mode-btn offline" onclick="selectMode('offline')">
                <div class="mode-icon">ğŸ’»</div>
                <div class="mode-title">Ø­Ø§Ù„Øª Ø¢ÙÙ„Ø§ÛŒÙ†</div>
                <div class="mode-desc">
                    Ù†ØµØ¨ Ø±ÙˆÛŒ Ø§ÛŒÙ† Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ±<br>
                    Ú©Ø§Ø±Ú©Ø±Ø¯ Ù…Ø³ØªÙ‚Ù„ Ùˆ Ù…Ø­Ù„ÛŒ
                </div>
            </div>
        </div>

        <!-- Ù¾Ù†Ù„ Ù†ØµØ¨ Ø¢ÙÙ„Ø§ÛŒÙ† -->
        <div class="installation-panel" id="installationPanel">
            <h3>ğŸ› ï¸ Ù†ØµØ¨ Ø³ÛŒØ³ØªÙ… Ø¢ÙÙ„Ø§ÛŒÙ†</h3>
            <p>Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ ÙˆØ¶Ø¹ÛŒØª Ù†ØµØ¨...</p>

            <div class="progress-container">
                <div class="progress-bar" id="progressBar"></div>
            </div>

            <!-- Ù…Ø±Ø­Ù„Ù‡ 1: Ø¨Ø±Ø±Ø³ÛŒ Ù†ØµØ¨ -->
            <div class="step" id="step1">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">Ø¨Ø±Ø±Ø³ÛŒ Ù†ØµØ¨ Ù‚Ø¨Ù„ÛŒ</div>
                    <div class="step-status status-pending" id="step1Status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
                </div>
                <div class="step-description">
                    Ø¨Ø±Ø±Ø³ÛŒ Ù…ÛŒâ€ŒÚ©Ù†ÛŒÙ… Ø¢ÛŒØ§ Ø³ÛŒØ³ØªÙ… Ø¢ÙÙ„Ø§ÛŒÙ† Ù‚Ø¨Ù„Ø§Ù‹ Ø±ÙˆÛŒ Ø§ÛŒÙ† Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ± Ù†ØµØ¨ Ø´Ø¯Ù‡ Ø§Ø³Øª ÛŒØ§ Ø®ÛŒØ±.
                </div>
                <div class="step-actions">
                    <button class="btn btn-primary" onclick="checkInstallation()" id="step1Btn">
                        Ø´Ø±ÙˆØ¹ Ø¨Ø±Ø±Ø³ÛŒ
                    </button>
                </div>
            </div>

            <!-- Ù…Ø±Ø­Ù„Ù‡ 2: Ù†ØµØ¨ Ø³ÛŒØ³ØªÙ… -->
            <div class="step" id="step2" style="display: none;">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">Ù†ØµØ¨ Ø³ÛŒØ³ØªÙ… Ø¢ÙÙ„Ø§ÛŒÙ†</div>
                    <div class="step-status status-pending" id="step2Status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
                </div>
                <div class="step-description">
                    Ø¯Ø§Ù†Ù„ÙˆØ¯ Ùˆ Ù†ØµØ¨ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù„Ø§Ø²Ù… Ø¨Ø±Ø§ÛŒ Ø§Ø¬Ø±Ø§ÛŒ Ø¢ÙÙ„Ø§ÛŒÙ† Ø³ÛŒØ³ØªÙ… Ø±ÙˆÛŒ Ø§ÛŒÙ† Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ±.
                </div>
                <div class="step-actions">
                    <button class="btn btn-primary" onclick="installOfflineSystem()" id="step2Btn" disabled>
                        Ø´Ø±ÙˆØ¹ Ù†ØµØ¨
                    </button>
                </div>
            </div>

            <!-- Ù…Ø±Ø­Ù„Ù‡ 3: Ø§ÛŒØ¬Ø§Ø¯ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ -->
            <div class="step" id="step3" style="display: none;">
                <div class="step-header">
                    <div class="step-number">3</div>
                    <div class="step-title">Ø§ÛŒØ¬Ø§Ø¯ Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ù…Ø­Ù„ÛŒ</div>
                    <div class="step-status status-pending" id="step3Status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
                </div>
                <div class="step-description">
                    Ø§ÛŒØ¬Ø§Ø¯ Ù¾Ø§ÛŒÚ¯Ø§Ù‡ Ø¯Ø§Ø¯Ù‡ SQLite Ø¨Ø±Ø§ÛŒ Ø°Ø®ÛŒØ±Ù‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ù‡ ØµÙˆØ±Øª Ù…Ø­Ù„ÛŒ.
                </div>
                <div class="step-actions">
                    <button class="btn btn-primary" onclick="createLocalDatabase()" id="step3Btn" disabled>
                        Ø§ÛŒØ¬Ø§Ø¯ Ø¯ÛŒØªØ§Ø¨ÛŒØ³
                    </button>
                </div>
            </div>

            <!-- Ù…Ø±Ø­Ù„Ù‡ 4: Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ -->
            <div class="step" id="step4" style="display: none;">
                <div class="step-header">
                    <div class="step-number">4</div>
                    <div class="step-title">Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯</div>
                    <div class="step-status status-pending" id="step4Status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
                </div>
                <div class="step-description">
                    Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ ØªÙ…Ø§Ù… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ fresh.
                </div>
                <div class="step-actions">
                    <button class="btn btn-primary" onclick="clearExistingData()" id="step4Btn" disabled>
                        Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§
                    </button>
                </div>
            </div>

            <!-- Ù…Ø±Ø­Ù„Ù‡ 5: Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ -->
            <div class="step" id="step5" style="display: none;">
                <div class="step-header">
                    <div class="step-number">5</div>
                    <div class="step-title">Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ø§Ø¯Ù‡ Ø§Ø² Ø³Ø±ÙˆØ±</div>
                    <div class="step-status status-pending" id="step5Status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
                </div>
                <div class="step-description">
                    Ø¯Ø±ÛŒØ§ÙØª ØªÙ…Ø§Ù… Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø§Ø² Ø³Ø±ÙˆØ± Ø§ØµÙ„ÛŒ Ùˆ Ø°Ø®ÛŒØ±Ù‡ Ø¯Ø± Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ù…Ø­Ù„ÛŒ.
                </div>
                <div class="step-actions">
                    <button class="btn btn-primary" onclick="transferDataFromServer()" id="step5Btn" disabled>
                        Ø´Ø±ÙˆØ¹ Ø§Ù†ØªÙ‚Ø§Ù„
                    </button>
                </div>
            </div>

            <!-- Ù…Ø±Ø­Ù„Ù‡ 6: Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø± Ù…Ø¯ÛŒØ± -->
            <div class="step" id="step6" style="display: none;">
                <div class="step-header">
                    <div class="step-number">6</div>
                    <div class="step-title">Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø± Ù…Ø¯ÛŒØ±</div>
                    <div class="step-status status-pending" id="step6Status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
                </div>
                <div class="step-description">
                    Ø§ÛŒØ¬Ø§Ø¯ Ø­Ø³Ø§Ø¨ Ù…Ø¯ÛŒØ± Ø³ÛŒØ³ØªÙ… Ø¨Ø§ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ Ùˆ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ± Ø¨Ø±Ø§Ø¨Ø± IP Ø§ÛŒÙ† Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ±.
                </div>
                <div class="step-actions">
                    <button class="btn btn-primary" onclick="createSuperuser()" id="step6Btn" disabled>
                        Ø§ÛŒØ¬Ø§Ø¯ Ú©Ø§Ø±Ø¨Ø±
                    </button>
                </div>
            </div>

            <!-- Ù…Ø±Ø­Ù„Ù‡ 7: Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§ -->
            <div class="step" id="step7" style="display: none;">
                <div class="step-header">
                    <div class="step-number">7</div>
                    <div class="step-title">Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø³ÛŒÙ†Ú©</div>
                    <div class="step-status status-pending" id="step7Status">Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±</div>
                </div>
                <div class="step-description">
                    Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ù„Ø§Ú¯â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ ØªÙ…ÛŒØ².
                </div>
                <div class="step-actions">
                    <button class="btn btn-success" onclick="clearSyncLogs()" id="step7Btn" disabled>
                        ØªÚ©Ù…ÛŒÙ„ Ù†ØµØ¨
                    </button>
                </div>
            </div>

            <!-- Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÙˆÙ¾Ø±ÛŒÙˆØ²Ø± -->
            <div class="superuser-info" id="superuserInfo">
                <h4>ğŸ‘‘ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ú©Ø§Ø±Ø¨Ø± Ù…Ø¯ÛŒØ±</h4>
                <div id="superuserContent"></div>
            </div>
        </div>
    </div>

    <!-- Ù†Ø§Ø­ÛŒÙ‡ Ù†ÙˆØªÛŒÙÛŒÚ©ÛŒØ´Ù† -->
    <div id="notificationArea"></div>

    <script>
        const clientIp = "{{ client_ip }}";
        let currentStep = 1;

        function selectMode(mode) {
            if (mode === 'online') {
                // Ø­Ø§Ù„Øª Ø¢Ù†Ù„Ø§ÛŒÙ† - redirect Ø¨Ù‡ ØµÙØ­Ù‡ Ø§ØµÙ„ÛŒ
                window.location.href = '/';
            } else if (mode === 'offline') {
                // Ø­Ø§Ù„Øª Ø¢ÙÙ„Ø§ÛŒÙ† - Ù†Ù…Ø§ÛŒØ´ Ù¾Ù†Ù„ Ù†ØµØ¨
                document.getElementById('installationPanel').style.display = 'block';
                checkInstallation();
            }
        }

        function showNotification(message, type) {
            const notificationArea = document.getElementById('notificationArea');
            const notification = document.createElement('div');
            notification.className = `notification ${type} show`;
            notification.innerHTML = message;
            
            notificationArea.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 5000);
        }

        function updateProgress(percentage) {
            document.getElementById('progressBar').style.width = percentage + '%';
        }

        function updateStepStatus(stepNumber, status, message = '') {
            const stepElement = document.getElementById(`step${stepNumber}Status`);
            stepElement.className = `step-status status-${status}`;
            
            const statusText = {
                'pending': 'Ø¯Ø± Ø§Ù†ØªØ¸Ø§Ø±',
                'running': 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ø¬Ø±Ø§',
                'completed': 'ØªÚ©Ù…ÛŒÙ„ Ø´Ø¯'
            };
            
            stepElement.textContent = message || statusText[status];
        }

        function enableNextStep(currentStep) {
            const nextStep = currentStep + 1;
            if (nextStep <= 7) {
                document.getElementById(`step${nextStep}`).style.display = 'block';
                document.getElementById(`step${nextStep}Btn`).disabled = false;
            }
        }

        async function checkInstallation() {
            updateStepStatus(1, 'running', 'Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø±Ø±Ø³ÛŒ...');
            
            try {
                const response = await fetch('/check-offline-installation/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCSRFToken()
                    },
                    body: JSON.stringify({ client_ip: clientIp })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    if (data.is_installed) {
                        updateStepStatus(1, 'completed', 'Ù‚Ø¨Ù„Ø§Ù‹ Ù†ØµØ¨ Ø´Ø¯Ù‡');
                        showNotification('âš ï¸ Ø³ÛŒØ³ØªÙ… Ù‚Ø¨Ù„Ø§Ù‹ Ù†ØµØ¨ Ø´Ø¯Ù‡ Ø§Ø³Øª', 'error');
                    } else {
                        updateStepStatus(1, 'completed', 'Ø¢Ù…Ø§Ø¯Ù‡ Ø¨Ø±Ø§ÛŒ Ù†ØµØ¨');
                        showNotification('âœ… Ø³ÛŒØ³ØªÙ… Ø¢Ù…Ø§Ø¯Ù‡ Ù†ØµØ¨ Ø§Ø³Øª', 'success');
                        enableNextStep(1);
                        updateProgress(14);
                    }
                }
            } catch (error) {
                updateStepStatus(1, 'completed', 'Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±Ø±Ø³ÛŒ');
                showNotification('âŒ Ø®Ø·Ø§ Ø¯Ø± Ø¨Ø±Ø±Ø³ÛŒ Ù†ØµØ¨', 'error');
            }
        }

        async function installOfflineSystem() {
            updateStepStatus(2, 'running', 'Ø¯Ø± Ø­Ø§Ù„ Ù†ØµØ¨...');
            
            try {
                const response = await fetch('/start-offline-installation/', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'X-CSRFToken': getCSRFToken()
                    },
                    body: JSON.stringify({ client_ip: clientIp })
                });
                
                const data = await response.json();
                
                if (data.status === 'success') {
                    updateStepStatus(2, 'completed', 'Ù†ØµØ¨ Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯');
                    showNotification('âœ… Ù†ØµØ¨ Ø³ÛŒØ³ØªÙ… Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', 'success');
                    enableNextStep(2);
                    updateProgress(28);
                }
            } catch (error) {
                updateStepStatus(2, 'completed', 'Ø®Ø·Ø§ Ø¯Ø± Ù†ØµØ¨');
                showNotification('âŒ Ø®Ø·Ø§ Ø¯Ø± Ù†ØµØ¨ Ø³ÛŒØ³ØªÙ…', 'error');
            }
        }

        async function createLocalDatabase() {
            updateStepStatus(3, 'running', 'Ø¯Ø± Ø­Ø§Ù„ Ø§ÛŒØ¬Ø§Ø¯...');
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø¯ÛŒØªØ§Ø¨ÛŒØ³
            setTimeout(() => {
                updateStepStatus(3, 'completed', 'Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯');
                showNotification('âœ… Ø¯ÛŒØªØ§Ø¨ÛŒØ³ Ù…Ø­Ù„ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯', 'success');
                enableNextStep(3);
                updateProgress(42);
            }, 2000);
        }

        async function clearExistingData() {
            updateStepStatus(4, 'running', 'Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ...');
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ
            setTimeout(() => {
                updateStepStatus(4, 'completed', 'Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯');
                showNotification('âœ… Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù‚Ø¯ÛŒÙ…ÛŒ Ù¾Ø§Ú© Ø´Ø¯Ù†Ø¯', 'success');
                enableNextStep(4);
                updateProgress(56);
            }, 1500);
        }

        async function transferDataFromServer() {
            updateStepStatus(5, 'running', 'Ø¯Ø± Ø­Ø§Ù„ Ø§Ù†ØªÙ‚Ø§Ù„...');
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ø§Ø¯Ù‡
            setTimeout(() => {
                updateStepStatus(5, 'completed', 'Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ Ù…Ù†ØªÙ‚Ù„ Ø´Ø¯Ù†Ø¯');
                showNotification('âœ… Ø§Ù†ØªÙ‚Ø§Ù„ Ø¯Ø§Ø¯Ù‡ Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯', 'success');
                enableNextStep(5);
                updateProgress(70);
            }, 3000);
        }

        async function createSuperuser() {
            updateStepStatus(6, 'running', 'Ø¯Ø± Ø­Ø§Ù„ Ø§ÛŒØ¬Ø§Ø¯...');
            
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ø§ÛŒØ¬Ø§Ø¯ Ø³ÙˆÙ¾Ø±ÛŒÙˆØ²Ø±
            setTimeout(() => {
                updateStepStatus(6, 'completed', 'Ú©Ø§Ø±Ø¨Ø± Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯');
                showNotification('âœ… Ú©Ø§Ø±Ø¨Ø± Ù…Ø¯ÛŒØ± Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯', 'success');
                
                // Ù†Ù…Ø§ÛŒØ´ Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø³ÙˆÙ¾Ø±ÛŒÙˆØ²Ø±
                document.getElementById('superuserInfo').style.display = 'block';
                document.getElementById('superuserContent').innerHTML = `
                    <p><strong>ğŸ“ Ù†Ø§Ù… Ú©Ø§Ù…Ù¾ÛŒÙˆØªØ±:</strong> ${clientIp}</p>
                    <p><strong>ğŸ‘¤ Ù†Ø§Ù… Ú©Ø§Ø±Ø¨Ø±ÛŒ:</strong> <code>${clientIp}</code></p>
                    <p><strong>ğŸ”‘ Ø±Ù…Ø² Ø¹Ø¨ÙˆØ±:</strong> <code>${clientIp}</code></p>
                    <p><em>ğŸ’¡ Ø§Ø² Ø§ÛŒÙ† Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¨Ø±Ø§ÛŒ ÙˆØ±ÙˆØ¯ Ø¨Ù‡ Ø³ÛŒØ³ØªÙ… Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯</em></p>
                `;
                
                enableNextStep(6);
                updateProgress(85);
            }, 1500);
        }

        async function clearSyncLogs() {
            updateStepStatus(7, 'running', 'Ø¯Ø± Ø­Ø§Ù„ Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ...');
            
            // Ø´Ø¨ÛŒÙ‡â€ŒØ³Ø§Ø²ÛŒ Ù¾Ø§Ú©Ø³Ø§Ø²ÛŒ Ù„Ø§Ú¯
            setTimeout(() => {
                updateStepStatus(7, 'completed', 'Ù†ØµØ¨ Ú©Ø§Ù…Ù„ Ø´Ø¯');
                showNotification('ğŸ‰ Ù†ØµØ¨ Ø³ÛŒØ³ØªÙ… Ø¢ÙÙ„Ø§ÛŒÙ† Ø¨Ø§ Ù…ÙˆÙÙ‚ÛŒØª Ø§Ù†Ø¬Ø§Ù… Ø´Ø¯!', 'success');
                updateProgress(100);
                
                // Ù†Ù…Ø§ÛŒØ´ Ù¾ÛŒØ§Ù… Ù†Ù‡Ø§ÛŒÛŒ
                setTimeout(() => {
                    alert('âœ… Ù†ØµØ¨ Ú©Ø§Ù…Ù„ Ø´Ø¯!\n\nØ³ÛŒØ³ØªÙ… Ø¢ÙÙ„Ø§ÛŒÙ† Ø¢Ù…Ø§Ø¯Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ø§Ø³Øª.\n\nØ¨Ø±Ø§ÛŒ Ø´Ø±ÙˆØ¹ Ú©Ø§Ø± Ø¨Ù‡ Ø¢Ø¯Ø±Ø³ Ø²ÛŒØ± Ù…Ø±Ø§Ø¬Ø¹Ù‡ Ú©Ù†ÛŒØ¯:\nhttp://localhost:8000');
                }, 1000);
            }, 1000);
        }

        function getCSRFToken() {
            const name = 'csrftoken';
            let cookieValue = null;
            if (document.cookie && document.cookie !== '') {
                const cookies = document.cookie.split(';');
                for (let i = 0; i < cookies.length; i++) {
                    const cookie = cookies[i].trim();
                    if (cookie.substring(0, name.length + 1) === (name + '=')) {
                        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                        break;
                    }
                }
            }
            return cookieValue;
        }
    </script>
</body>
</html>